# 粒子解析プログラムの使い方ガイド

このプログラムは、顕微鏡写真のような専門的な画像（TIFF画像と呼ばれます）に写っているたくさんの小さな粒子を、自動で数えたり、大きさを測ったりするためのツールです。

このガイドでは、プログラミングに詳しくない方でも、手順通りに進めればプログラムを使えるように、丁寧に説明します。

## 1. 準備編：プログラムを動かす前に

まず、お使いのパソコンでプログラムを動かすための準備をします。

### ステップ1：必要なものをインストールする

このプログラムは、いくつかの専門的な計算ツール（ライブラリと呼びます）の助けを借りて動きます。
以下の手順で、それらをパソコンにインストールしましょう。

1.  **ターミナル（またはコマンドプロンプト）を開きます。**
    *   **Macの場合:** `アプリケーション`フォルダの中の`ユーティリティ`フォルダにある`ターミナル.app`を開きます。
    *   **Windowsの場合:** スタートメニューで`cmd`と検索して、`コマンドプロンプト`を開きます。

2.  **以下の呪文（コマンド）をコピーして、ターミナルに貼り付け、Enterキーを押します。**
    これにより、必要なツールが一括でインストールされます。

    ```bash
    pip install opencv-python numpy matplotlib scikit-image scikit-learn tqdm
    ```

    （もし`pip`というコマンドが無いとエラーが出た場合は、先にPython本体のインストールが必要です。その際は別途ご相談ください。）

### ステップ2：解析したい画像を指定する

次に、あなたが解析したいご自身の画像ファイルを、プログラムに教えてあげる必要があります。

1.  **`main.py`というファイルを開きます。**
    このファイルは、プログラムの設計図のようなものです。メモ帳やテキストエディタで開くことができます。

2.  **ファイルの中の`paths = [...]`と書かれている部分を探します。**
    はじめは、以下のように書かれているはずです。

    ```python
    def main():
        """メイン処理"""
        paths = [
            "path/to/binary_image_stack.tif",
        ]
    ```

3.  **`"path/to/binary_image_stack.tif"`の部分を、あなたが解析したい画像のファイルの場所（パス）に書き換えます。**

    **書き換え方の例：**

    *   **Macで、デスクトップにある`my_image.tif`というファイルを解析したい場合**
        （`your_username`の部分は、ご自身のユーザー名に置き換えてください）

        ```python
        paths = [
            "/Users/your_username/Desktop/my_image.tif",
        ]
        ```

    *   **Windowsで、ドキュメントフォルダにある`my_image.tif`というファイルを解析したい場合**
        （`your_username`の部分は、ご自身のユーザー名に置き換えてください）

        ```python
        paths = [
            "C:/Users/your_username/Documents/my_image.tif",
        ]
        ```
        **（注意：Windowsの場合、パスの区切り文字`\`は`/`に置き換えてください）**

    *   **複数の画像を一度に解析したい場合**
        カンマ`,`で区切って、複数の画像を指定することもできます。

        ```python
        paths = [
            "/Users/your_username/Desktop/image1.tif",
            "/Users/your_username/Desktop/image2.tif",
        ]
        ```

4.  **ファイルを上書き保存します。**

これで準備は完了です！

## 2. 実行編：プログラムを動かしてみる

いよいよプログラムを実行して、画像の解析を始めます。

1.  **準備編で使ったターミナル（またはコマンドプロンプト）を再度開きます。**

2.  **以下の呪文（コマンド）をコピーして、ターミナルに貼り付け、Enterキーを押します。**

    ```bash
    python main.py
    ```

3.  **解析が始まります。** パソコンが計算を頑張るので、少し時間がかかる場合があります。じっと待っていてください。
    ターミナルに特に何もエラーメッセージが表示されなければ、成功です。

## 3. 結果編：解析されたデータを見てみる

解析が終わると、`particle_analyze`フォルダの中に`dist`という新しいフォルダが作られ、その中に結果が保存されます。

`dist`フォルダの中は、さらに以下のように分かれています。

*   `dist/detected/`
    *   プログラムが「これが粒子だ」と認識した部分を、カラフルに色付けした画像が入っています。元画像と見比べて、正しく認識できているか確認できます。

*   `dist/segmented/`
    *   プログラムが粒子をどのように切り分けたかを示す、少し専門的な画像です。

*   `dist/histogram/`
    *   見つかった粒子の**大きさ（直径）** をグラフにした画像（ヒストグラム）です。どのくらいの大きさの粒子が、それぞれ何個くらいあったかが一目で分かります。

*   `dist/csv/`
    *   見つかった粒子一つ一つの**直径の生データ**が記録されたファイルです。Excelなどで開くことができ、ご自身でさらに詳しい分析をしたい場合に使えます。

## 困ったときは

*   **エラーが出た:** ターミナルに表示されたエラーメッセージをコピーして、開発担当の方にご相談ください。
*   **設定を細かく変えたい:** `modules/config.py`というファイルを編集すると、解析の感度などを調整できますが、専門的な知識が必要です。まずは開発担当の方にご相談することをおすすめします。
